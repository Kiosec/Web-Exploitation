# GitLab CVE-2023-7028

## Context 

 In Jan 2024, the platform identified a critical vulnerability in its Community (CE) and Enterprise Edition (EE) that allows unauthorised users to take over user accounts, p
otentially including administrator accounts, without any interaction from the victim. The vulnerability was identified by asterion04 through a private bug bounty program and was assigned the severity Critical and CVE-ID 2023-7028.


## Affected Versions

All instances of GitLab CE/EE using the following versions were vulnerable:
```
16.1 to 16.1.5
16.2 to 16.2.8
16.3 to 16.3.6
16.4 to 16.4.4
16.5 to 16.5.5
16.6 to 16.6.3
16.7 to 16.7.1
```

## Detailed Technical Explanation

The vulnerability is present into the resert password function.

If we look at the password reset request in GitLab, we can see it is requesting to the /users/password endpoint with authenticity_token (hidden CSRF protection token) and email address as a parameter. If a target provides another secondary email address, a password reset token is also sent to the address. 

![image](https://github.com/Kiosec/Web-Exploitation/assets/100965892/24c0e8ab-774f-4c90-a62c-0538c4a2f6f3)


#### Details
https://tryhackme.com/room/gitlabcve20237028


## Exploitation and POC

#### Original POC
Poc developed by Vozec : https://github.com/Vozec/CVE-2023-7028/tree/main

#### Modified POC (THM)

The exploit is directly in the folder (poc.py)

```
kiosec@cyberlab$ python3 attack.py -u http://10.0.0.1:8000 -t victim@mail.fr -e attacker@mail.fr
```



